<table class="grade-table centered-table">
  <thead>
    <tr>
      <th></th>
      <th class="criterion-title-column translate" data-translate="criterion">Criterion</th>
      <th class="status-column translate" data-translate="status">Status</th>
      <th class="type-column translate" data-translate="type">Type</th>
      <th class="comment-column translate" data-translate="comment">Comment</th>
      <th class="lock-column translate" data-translate="lock">Lock</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let criterion of criteriaList; let i = index">
      <td style="padding: 0;">{{ i + 1 }}</td>

      <td style="text-align: start !important; max-width: 400px;" class="break-text">{{ criterion.criterium }}</td>

      <td>
        <!-- Status jako tekst gdy zablokowany -->
        <ng-container *ngIf="!criterion.enableForModification; else statusSelect">
          <span [class]="getStatusClass(criterion.levelOfRealization)" class="status-text">
            {{ getStatusLabel(criterion.levelOfRealization) }}
          </span>
        </ng-container>
        
        <ng-template #statusSelect>
          <select [(ngModel)]="criterion.levelOfRealization"
                  (change)="onLevelChange($event, criterion.id)"
                  class="status-select"
                  [class.status-in-progress]="criterion.levelOfRealization === 'IN_PROGRESS'"
                  [class.status-partially-completed]="criterion.levelOfRealization === 'PARTIALLY_COMPLETED'"
                  [class.status-completed]="criterion.levelOfRealization === 'COMPLETED'">
            <option value="IN_PROGRESS" class="translate" data-translate="in_progress">In Progress</option>
            <option value="PARTIALLY_COMPLETED" class="translate" data-translate="partially_completed">Partially Completed</option>
            <option value="COMPLETED" class="translate" data-translate="completed">Completed</option>
          </select>
        </ng-template>
      </td>

      <td style="font-size: 16px !important;">
        {{ getTypeLabel(criterion.type) }}
      </td>

      <td>
        <!-- Komentarz jako tekst gdy zablokowany -->
        <ng-container *ngIf="!criterion.enableForModification; else commentTextarea">
          <div class="comment-text" [class.empty-comment]="!criterion.comment">
            {{ criterion.comment || 'No comment' }}
          </div>
        </ng-container>
        
        <ng-template #commentTextarea>
          <textarea
            [value]="criterion.comment || ''"
            (blur)="onCommentChange($event, criterion.id)"
            placeholder="Enter comment"
            style="width: 100%; min-height: 40px; resize: vertical; padding: 4px;">
          </textarea>
        </ng-template>
      </td>

      <td style="text-align: center; display: flex; justify-content: center; align-items: center;">
        <button mat-icon-button class="lock-button"
                (click)="onToggleLock(criterion.id!, !criterion.enableForModification)"
                [matTooltip]="criterion.enableForModification ? 'Click to lock' : 'Click to unlock'">
          <mat-icon color="primary">
            {{ criterion.enableForModification ? 'lock_open' : 'lock' }}
          </mat-icon>
        </button>
      </td>

      <td style="padding: 0;">
        <button class="delete-button"
                (click)="openConfirmDialog(criterion.id!); $event.stopPropagation(); $event.preventDefault()">
          <mat-icon style="margin: 0;">delete</mat-icon>
        </button>
      </td>
    </tr>
  </tbody>
</table>

<ng-template [ngIf]="criteriaList.length === 0">
  <p style="text-align: center; margin-top: 100px;" class="translate" data-translate="no_criteria_available">No criteria available. Please add a new one.</p>
</ng-template>